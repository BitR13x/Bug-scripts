        <script>
            let notes = [];
            let noteIdCounter = 1;
            
            // Load notes from localStorage on page load
            document.addEventListener('DOMContentLoaded', function() {
                loadNotesFromStorage();
                updateNotesDisplay();
            });
            
            function loadNotesFromStorage() {
                const savedNotes = localStorage.getItem('ctf-notes-' + window.location.pathname);
                if (savedNotes) {
                    try {
                        notes = JSON.parse(savedNotes);
                        noteIdCounter = Math.max(...notes.map(n => n.id), 0) + 1;
                    } catch (e) {
                        console.error('Failed to load notes from storage:', e);
                        notes = [];
                    }
                }
            }
            
            function saveNotesToStorage() {
                try {
                    localStorage.setItem('ctf-notes-' + window.location.pathname, JSON.stringify(notes));
                } catch (e) {
                    console.error('Failed to save notes to storage:', e);
                }
            }
            
            function addNote() {
                const form = document.getElementById('add-note-form');
                form.style.display = form.style.display === 'none' ? 'block' : 'none';
                
                if (form.style.display === 'block') {
                    document.getElementById('note-title').focus();
                }
            }
            
            function cancelNote() {
                document.getElementById('add-note-form').style.display = 'none';
                clearForm();
            }
            
            function saveNote() {
                const title = document.getElementById('note-title').value.trim();
                const content = document.getElementById('note-content').value.trim();
                const category = document.getElementById('note-category').value;
                
                if (!title || !content) {
                    alert('Please fill in both title and content.');
                    return;
                }
                
                const note = {
                    id: noteIdCounter++,
                    title: title,
                    content: content,
                    category: category,
                    timestamp: new Date().toLocaleString()
                };
                
                notes.unshift(note); // Add to beginning of array
                saveNotesToStorage();
                updateNotesDisplay();
                cancelNote();
            }
            
            function deleteNote(noteId) {
                if (confirm('Are you sure you want to delete this note?')) {
                    notes = notes.filter(note => note.id !== noteId);
                    saveNotesToStorage();
                    updateNotesDisplay();
                }
            }
            
            function editNote(noteId) {
                const note = notes.find(n => n.id === noteId);
                if (!note) return;
                
                document.getElementById('note-title').value = note.title;
                document.getElementById('note-content').value = note.content;
                document.getElementById('note-category').value = note.category;
                
                // Remove the old note and show form
                deleteNote(noteId);
                addNote();
            }
            
            function clearForm() {
                document.getElementById('note-title').value = '';
                document.getElementById('note-content').value = '';
                document.getElementById('note-category').value = 'general';
            }
            
            function updateNotesDisplay() {
                const notesList = document.getElementById('notes-list');
                const notesCount = document.getElementById('notes-count');
                
                notesCount.textContent = notes.length;
                
                if (notes.length === 0) {
                    notesList.innerHTML = '<div class="empty-notes">No notes yet. Click "Add Note" to get started!</div>';
                    return;
                }
                
                notesList.innerHTML = notes.map(note => `
                    <div class="note-item">
                        <div class="note-header">
                            <div class="note-title">${escapeHtml(note.title)}</div>
                            <div class="note-category ${note.category}">${note.category}</div>
                        </div>
                        <div class="note-content">${escapeHtml(note.content)}</div>
                        <div class="note-meta">
                            <span>${note.timestamp}</span>
                            <div class="note-actions">
                                <button class="note-action-btn" onclick="editNote(${note.id})" title="Edit">‚úèÔ∏è</button>
                                <button class="note-action-btn" onclick="copyToClipboard('${escapeHtml(note.content).replace(/'/g, "\\'")}')">üìã</button>
                                <button class="note-action-btn" onclick="deleteNote(${note.id})" title="Delete">üóëÔ∏è</button>
                            </div>
                        </div>
                    </div>
                `).join('');
            }
            
            function exportNotes() {
                if (notes.length === 0) {
                    alert('No notes to export.');
                    return;
                }
                
                let exportText = '# CTF Notes Export\n';
                exportText += '- Generated: ' + new Date().toLocaleString() + '\n\n';
                
                notes.forEach(note => {
                    exportText += `## ${note.title} [${note.category.toUpperCase()}]\n`;
                    exportText += `**Date:** ${note.timestamp}\n\n`;
                    exportText += `${note.content}\n\n`;
                    exportText += '---\n\n';
                });
                
                // Create and download file
                const blob = new Blob([exportText], { type: 'text/markdown' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'ctf-notes-' + new Date().toISOString().split('T')[0] + '.md';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            }
            
            function clearAllNotes() {
                if (notes.length === 0) {
                    alert('No notes to clear.');
                    return;
                }
                
                if (confirm('Are you sure you want to delete ALL notes? This cannot be undone.')) {
                    notes = [];
                    saveNotesToStorage();
                    updateNotesDisplay();
                }
            }
            
            function escapeHtml(text) {
                const div = document.createElement('div');
                div.textContent = text;
                return div.innerHTML;
            }
        </script>
